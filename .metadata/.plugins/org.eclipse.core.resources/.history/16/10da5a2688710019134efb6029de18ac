package modelos;

import java.time.LocalDate;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.List;

public class Concurso {

	// Variables
	private int id;
	private String codigo;
	private String nombre;
	private Categoria categoria;
	private LocalDate aperturaInscripcion;
	private LocalDate cierreInscripcion;
	private LocalDate aperturaPublicacion;
	private LocalDate cierrePublicacion;
	private int horaAperturaInscripcion;
	private int horaFinInscripcion;
	private int horaAperturaPublicacion;
	private int horaFinPublicacion;
	private String hashtag;
	private boolean corregido;
	private List<Puesto> puestos = new ArrayList<Puesto>();

	/* constructores */
	public Concurso() { }
	
	public Concurso(int id) {
		this.id = id;
	}
	
	public Concurso(int id, String nombre) { 
		this.id = id;
		this.nombre = nombre;
	}
	
	public Concurso(String codigo, String nombre, String hashtag, Categoria categoria, LocalDate aperturaInscripcion,
			LocalDate cierreInscripcion, LocalDate aperturaPublicacion, LocalDate cierrePublicacion, int horaInicioInscripcion,
			int horaFinInscripcion, int horaInicioPublicacion, int horaFinPublicacion) {
		validarConcurso(codigo, nombre, hashtag, categoria);
		validarFechas(aperturaInscripcion, cierreInscripcion, aperturaPublicacion, cierrePublicacion, horaInicioInscripcion,
				horaFinInscripcion, horaInicioPublicacion, horaFinPublicacion);
		this.codigo = codigo;
		this.nombre = nombre;
		this.hashtag = hashtag;
		this.categoria = categoria;
		this.aperturaInscripcion = aperturaInscripcion;
		this.cierreInscripcion = cierreInscripcion;
		this.aperturaPublicacion = aperturaPublicacion;
		this.cierrePublicacion = cierrePublicacion;
		this.horaAperturaInscripcion = horaInicioInscripcion;
		this.horaFinInscripcion = horaFinInscripcion;
		this.horaAperturaPublicacion = horaInicioPublicacion;
		this.horaFinPublicacion = horaFinPublicacion;
		this.corregido = false;
	}

	public Concurso(int id, String codigo, String nombre, String hashtag, Categoria categoria, LocalDate aperturaInscripcion,
			LocalDate cierreInscripcion, LocalDate aperturaPublicacion, LocalDate cierrePublicacion, int horaInicioInscripcion,
			int horaFinInscripcion, int horaInicioPublicacion, int horaFinPublicacion, boolean corregido) {
		validarConcurso(codigo, nombre, hashtag, categoria);
		validarFechass(aperturaInscripcion, cierreInscripcion, aperturaPublicacion, cierrePublicacion, horaInicioInscripcion,
				horaFinInscripcion, horaInicioPublicacion, horaFinPublicacion);
		this.id = id;
		this.codigo = codigo;
		this.nombre = nombre;
		this.hashtag = hashtag;
		this.categoria = categoria;
		this.aperturaInscripcion = aperturaInscripcion;
		this.cierreInscripcion = cierreInscripcion;
		this.aperturaPublicacion = aperturaPublicacion;
		this.cierrePublicacion = cierrePublicacion;
		this.horaAperturaInscripcion = horaInicioInscripcion;
		this.horaFinInscripcion = horaFinInscripcion;
		this.horaAperturaPublicacion = horaInicioPublicacion;
		this.horaFinPublicacion = horaFinPublicacion;
		this.corregido = corregido;
	}
	
	/**
	 * Metodo que valida que el valor no sea vacio
	 * 
	 * @param codigo
	 *            parametro del tipo string
	 * @param nombre
	 *            parametro del tipo string 
	 * @param hashtag
	 *            parametro del tipo String            
	 */
	private void validarConcurso(String codigo, String nombre, String hashtag, Categoria categoria) {
		if(codigo.isEmpty() || codigo == ""){
			throw new RuntimeException("Ingrese un codigo");
		}
		if(nombre.isEmpty() || nombre == ""){
			throw new RuntimeException("Ingrese un nombre");
		}
		if(hashtag.isEmpty() || hashtag == ""){
			throw new RuntimeException("Ingrese un hashtag");
		}
		if (categoria == null){
			throw new RuntimeException("Ingrese una categoria");
		}
	}
	
	/**
	 * Metodo que valida las fechas y los horarios
	 *
	 * @param fechaApertura
	 *            parametro del tipo LocalDate 
	 * @param fechaCierre
	 *            parametro del tipo LocalDate 
	 */
	private void validarFechas(LocalDate aperturaInscripcion, LocalDate cierreInscripcion, LocalDate aperturaPublicacion,
			LocalDate cierrePublicacion, int horaAperturaInscripcion, int horaCierreInscripcion, int horaAperturaPublicacion, 
			int horaCierrePublicacion) {
		LocalDate hoy = LocalDate.now();
		@SuppressWarnings("deprecation")
		int horaActual = Calendar.getInstance().getTime().getHours();
		if (aperturaInscripcion.isBefore(hoy)) {
			throw new RuntimeException("La fecha de apertura de inscripcion no debe ser anterior a la fecha actual");
		} else {
			if (aperturaInscripcion.isEqual(hoy) && horaActual >= horaAperturaInscripcion){
				throw new RuntimeException("La hora de apertura de inscripcion debe ser posterior a la hora actual");
			}
		}
		if (cierreInscripcion.isBefore(aperturaInscripcion)) {
			throw new RuntimeException("La fecha de cierre inscripcion no debe ser anterior a la fecha de apertura de inscripcion");
		} else {
			if(aperturaInscripcion.isEqual(cierreInscripcion) && horaAperturaInscripcion >= horaCierreInscripcion) {
				throw new RuntimeException("La hora de cierre de inscripcion debe ser posterior a la hora de apertura de inscripcion");
			}
		}
		if (aperturaPublicacion.isBefore(cierreInscripcion)) {
			throw new RuntimeException("La fecha de apertura publicacion no debe ser anterior a la fecha de cierre de inscripcion");
		}
		//else {
			//if(aperturaPublicacion.isEqual(cierreInscripcion) && horaCierreInscripcion >= horaAperturaPublicacion) {
			////}
		//}
		if (cierrePublicacion.isBefore(aperturaPublicacion)) {
			throw new RuntimeException("La fecha de cierre publicacion no debe ser anterior a la fecha de apertura de publicacion");
		} else {
			if(aperturaPublicacion.isEqual(cierrePublicacion) && horaAperturaPublicacion >= horaCierrePublicacion) {
				throw new RuntimeException("La hora de cierre de publicacion debe ser posterior a la hora de apertura de publicacion");
			}
		}
	}
	
	/**
	 * Metodo que valida las fechas y los horarios
	 *
	 * @param fechaApertura
	 *            parametro del tipo LocalDate 
	 * @param fechaCierre
	 *            parametro del tipo LocalDate 
	 */
	private void validarFechass(LocalDate aperturaInscripcion, LocalDate cierreInscripcion, LocalDate aperturaPublicacion,
			LocalDate cierrePublicacion, int horaAperturaInscripcion, int horaCierreInscripcion, int horaAperturaPublicacion, 
			int horaCierrePublicacion) {
		if (cierreInscripcion.isBefore(aperturaInscripcion)) {
			throw new RuntimeException("La fecha de cierre inscripcion no debe ser anterior a la fecha de apertura de inscripcion");
		} else {
			if(aperturaInscripcion.isEqual(cierreInscripcion) && horaAperturaInscripcion >= horaCierreInscripcion) {
				throw new RuntimeException("La hora de cierre de inscripcion debe ser posterior a la hora de apertura de inscripcion");
			}
		}
		if (aperturaPublicacion.isBefore(cierreInscripcion)) {
			throw new RuntimeException("La fecha de apertura publicacion no debe ser anterior a la fecha de cierre de inscripcion");
		} else {
			if(aperturaPublicacion.isEqual(cierreInscripcion) && horaCierreInscripcion >= horaAperturaPublicacion) {
				throw new RuntimeException("La hora de apertura de publicacion debe ser posterior a la hora de apertura de inscripcion");
			}
		}
		if (cierrePublicacion.isBefore(aperturaPublicacion)) {
			throw new RuntimeException("La fecha de cierre publicacion no debe ser anterior a la fecha de apertura de publicacion");
		} else {
			if(aperturaPublicacion.isEqual(cierrePublicacion) && horaAperturaPublicacion >= horaCierrePublicacion) {
				throw new RuntimeException("La hora de cierre de publicacion debe ser posterior a la hora de apertura de publicacion");
			}
		}
	}

	// Getters
	public int getId() {
		return id;
	}
	
	public String getNombre() {
		return this.nombre;
	}
	
	public String getCodigo(){
		return this.codigo;
	}
	
	public Categoria getCategoria() {
		return this.categoria;
	}
	
	public LocalDate getFechaInicioInscripcion(){
		return this.aperturaInscripcion;
	}
	
	public int getHoraInicioInscripcion(){
		return this.horaAperturaInscripcion;
	}
	
	public LocalDate getFechaFinInscripcion() {
		return this.cierreInscripcion;
	}
	
	public int getHoraFinInscripcion(){
		return this.horaFinInscripcion;
	}
	
	public LocalDate getFechaInicioPublicacion(){
		return this.aperturaPublicacion;
	}
	
	public int getHoraInicioPublicacion() {
		return this.horaAperturaPublicacion;
	}
	
	public LocalDate getFechaFinPublicacion() {
		return this.cierrePublicacion;
	}
	
	public int getHoraFinPublicacion(){
		return this.horaFinPublicacion;
	}
	
	public String getHashtag() {
		return this.hashtag;
	}
	
	public boolean getCorregido() {
		return this.corregido;
	}
	
	public List<Puesto> getPuestos() {
		return this.puestos;
	}

	public String getEstado() {
		if (corregido) {
			return "corregido";
		}
		else return "no corregido";
	}
}
